{% extends "base.html" %}

{% block content %}

{% if user.is_superuser %}
<h3>Companies</h3>

<a href="{% url 'add_company' %}"
   class="btn btn-success mb-3">
   + Add Company
</a>


<table class="table table-bordered table-striped mb-5">

    <tr>
        <th>Name</th>
        <th>Departments</th>
        <th>Employees</th>
        <th>Actions</th>
    </tr>

    {% for c in companies %}

    <tr>

        <td>{{ c.name }}</td>
        <td>{{ c.departments_count }}</td>
        <td>{{ c.employees_count }}</td>

        <td>

            <a href="{% url 'edit_company' c.id %}"
               class="btn btn-sm btn-warning">
               Edit
            </a>

            <a href="{% url 'delete_company' c.id %}"
               class="btn btn-sm btn-danger">
               Delete
            </a>

        </td>

    </tr>

    {% endfor %}

</table>
{% endif %}
{% if user.is_superuser or is_manager %}

<h3>Departments</h3>

<a href="{% url 'add_department' %}"
   class="btn btn-success mb-3">
   + Add Department
</a>


<table class="table table-bordered table-striped mb-5">

<tr>
    <th>Name</th>
    <th>Company</th>
    <th>Employees</th>
    {% if user.is_superuser %}
    <th>Actions</th>
    {% endif %}
</tr>

{% for d in departments %}

<tr>

    <td>{{ d.name }}</td>
    <td>{{ d.company.name }}</td>
    <td>{{ d.employees_count }}</td>
    {% if user.is_superuser %}

    <td>

        <a href="{% url 'edit_department' d.id %}"
           class="btn btn-sm btn-warning">
           Edit
        </a>

        <a href="{% url 'delete_department' d.id %}"
           class="btn btn-sm btn-danger">
           Delete
        </a>

    </td>
    {% endif %}
</tr>

{% endfor %}

</table>
{% endif %}

<h3>Employees</h3>


{% if user.is_superuser or is_manager %}

    <a href="{% url 'add_employee' %}"
       class="btn btn-success mb-3">
       + Add Employee
    </a>

{% endif %}


<table class="table table-bordered table-striped">

    <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Company</th>
        <th>Department</th>
        <th>Status</th>
        <th>Designation</th>
        <th>Role</th>
        <th>Days Employed</th>
        {% if user.is_superuser or is_manager %}
        <th>Actions</th>
        {% endif %}
    </tr>


    {% for e in employees %}

    <tr>

        <td>{{ e.name }}</td>
        <td>{{ e.email }}</td>
        <td>{{ e.company.name }}</td>
        <td>{{ e.department.name }}</td>
        <td>{{ e.status }}</td>
        <td>{{ e.designation }}</td>
        <td>
            {% if e.is_manager %}
                Manager
            {% else %}
                Employee
            {% endif %}
        </td>
        <td>
            {% if e.days_employed %}
                {{ e.days_employed }} days
            {% else %}
                Not hired
            {% endif %}
        </td>
        {% if user.is_superuser or is_manager %}
        <td>
                <a href="{% url 'edit_employee' e.id %}"
                    class="btn btn-sm btn-warning">
                    Edit
                </a>

                <a href="{% url 'delete_employee' e.id %}"
                    class="btn btn-sm btn-danger">
                    Delete
                </a>
        </td>
        {% endif %}

    </tr>

    {% endfor %}

</table>

{% endblock %}